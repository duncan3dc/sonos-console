#!/usr/bin/env php
<?php

namespace duncan3dc\Sonos\Console;

use duncan3dc\Sonos\Network;
use Symfony\Component\Console\Application;
use Symfony\Component\Finder\Finder;

require __DIR__ . "/../vendor/autoload.php";

$sonos = new Application("Sonos Console", "0.0.2");

$commands = [];
$path = realpath(__DIR__ . "/../src");
$finder = (new Finder)->files()->in($path)->name("/[A-Z].*Command.php/");
foreach ($finder as $file) {
    $filename = $file->getRealPath();
    $filename = str_replace($path, "", $filename);
    $filename = str_replace(".php", "", $filename);
    $class = __NAMESPACE__ . str_replace("/", "\\", $filename);
    $commands[] = new $class;
}

$sonos->addCommands($commands);

Network::$cache = true;

$sonos->run();
